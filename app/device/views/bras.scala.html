@(email: String,lstBras : Seq[(String,String,String,String,String, String, String, String,String,Option[String])])
@import play.api.libs.json.Json

<!DOCTYPE html>

<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <!-- Meta, title, CSS, favicons, etc. -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Dashboard Admin </title>

            <!-- Bootstrap -->
        @common.views.html.common.css("Bras")
    </head>
    @common.views.html.common.top()
        <!-- top navigation -->
    <div class="top_nav">
        <div class="nav_menu">
            <nav>
                <div class="nav toggle" style="margin-bottom: 10px">
                    <a id="menu_toggle"><i class="fa fa-bars"></i></a>
                </div>
                <ul class="nav navbar-nav navbar-right">
                    <li class="">
                        <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                            <img src="../assets/images/user.default.png" alt="">@email
                            <span class=" fa fa-angle-down"></span>
                        </a>
                        <ul class="dropdown-menu dropdown-usermenu pull-right">
                            <li><a href="/logout"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>

        </div>
    </div>
        <!-- /top navigation -->
        <!-- page content -->
    <div class="right_col" role="main">

        <div class="row">
            <div class="x_panel">
                <div class="x_title">
                    <h2> List Bras Detail</h2>
                    <div class="clearfix"></div>
                </div>
                <table id="tbBras" class="table table-striped table-bordered animated slideInUp">
                    <thead>
                        <tr>
                            <th>Bras Id</th>
                            <th>Time</th>
                            <th>SignIn</th>
                            <th>Logoff</th>
                            <th>Actives</th>
                            <th>Cpe_error</th>
                            <th>Lostip_error</th>
                            <th>Crit_kibana</th>
                            <th>Crit_opsview</th>
                            <th>Label</th>
                            <th>Outlier</th>
                            <th>Normal</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if(lstBras != null){
                            @for(bras <- lstBras){
                                <tr>
                                    <td><a href="/brasInfo?id=@bras._1&time=@bras._2&sigin=@bras._4&logoff=@bras._5&timeCurrent=@bras._2" style="color: #1ABB9C;" class="activeHref">@bras._1</a></td>
                                    <td>@bras._2</td>
                                    <td>@bras._4</td>
                                    <td>@bras._5</td>
                                    <td>@bras._3</td>
                                    <td>@bras._6</td>
                                    <td>@bras._7</td>
                                    <td>@bras._8</td>
                                    <td>@bras._9</td>
                                    <td>
                                    @if(bras._10.isEmpty || bras._10.get == "0"){
                                        <span class="label label-danger lbOutlier" style="font-size: 13px">Outlier</span>
                                    }else{
                                        <span class="label label-success lbOutlier" style="font-size: 13px">Outlier</span>
                                    }
                                    </td>
                                    <td style="padding-top: 5px">
                                        <a onclick="confirmOutlier(this)" id="@bras._1/@bras._2.replace(" ","=").replace(":","_").replace(":","_").replace(".","%")" class="btn btn-primary a-btn-slide-text" style="padding: 0px 8px;margin-bottom: 0px;font-size: 12px">
                                            <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                            <span><strong>Confirm</strong></span>
                                        </a>
                                    </td>
                                    <td style="padding-top: 5px">
                                        <a onclick="rejectOutlier(this)" id="@bras._1/@bras._2" class="btn btn-primary a-btn-slide-text" style="padding: 0px 8px;margin-bottom: 0px;font-size: 12px">
                                            <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                            <span><strong>Reject</strong></span>
                                        </a>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
        <!-- /page content -->

        <!-- footer content -->
    <footer>
        <div class="pull-right">
            Dashboard Admin 21/09/2017
        </div>
        <div class="clearfix"></div>
    </footer>
        <!-- /footer content -->
        <!-- modal content -->

    <div class="modal fade" id="modalError" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    System error, Please review operation!
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    </div>
    </div>

        <!-- jQuery -->
    <script src="../assets/vendors/jquery/dist/jquery.min.js"></script>
        <!-- Bootstrap -->
    <script src="../assets/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
        <!-- Custom Theme Scripts -->
    <script src="../assets/custom/js/custom.min.js"></script>
        <!-- Hight chart -->
    <script src="../assets/javascripts/highcharts.js"></script>
    <script src="../assets/javascripts/exporting.js"></script>
        <!-- Counter number -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.3/waypoints.min.js"></script>
    <script src="../assets/javascripts/jquery.counterup.min.js"></script>
    <script type="text/javascript" src="../assets/javascripts/vis.min.js"></script>
        <!-- Datatable -->
    <script src="../assets/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="../assets/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <script src="../assets/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="../assets/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
    <script src="../assets/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
    <script src="../assets/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
    <script src="../assets/vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="../assets/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
    <script src="../assets/vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>

    <script type="text/javascript">

         function rejectOutlier(element){
             var strId = $(element).attr('id')
             var id = strId.split("/")[0]
             var time = strId.split("/")[1].replace('=',' ').replace('%', '.').replace(/_/g, ":");
             $.ajax({
                 url: "/rejectLabel?id="+id+"&time="+time,
                 success: function (data) {
                     if(data!= "error")
                        $(element).parent().parent().find('.lbOutlier').removeClass('label-success').addClass('label-danger');
                     else
                         $('#modalError').show();
                 }
             });
         }

         function confirmOutlier(element){
             var strId = $(element).attr('id')
             var id = strId.split("/")[0]
             var time = strId.split("/")[1].replace('=',' ').replace('%', '.').replace(/_/g, ":");
             $.ajax({
                 url: "/confirmLabel?id="+id+"&time="+time,
                 success: function (data) {
                     if(data!= "error")
                        $(element).parent().parent().find('.lbOutlier').removeClass('label-danger').addClass('label-success');
                     else
                         $('#modalError').show();
                 }
             });
         }

         function executeQuery() {
             window.location.reload(true);
         }
         $(document).ready(function() {
             $("#tbBras").DataTable({
                 "pageLength":20,
                 "order": [[ 1, "desc" ]]
             });
             setInterval(function() {
                 executeQuery()
             }, 2*60*1000);
         });


    </script>
    </body>
</html>